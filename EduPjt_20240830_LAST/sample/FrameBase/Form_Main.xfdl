<?xml version="1.0" encoding="utf-8"?>
<FDL version="2.1">
  <Form id="Form_Main" width="1280" height="720" titletext="New Form" onload="Form_Main_onload">
    <Layouts>
      <Layout height="720" mobileorientation="landscape" width="1280">
        <Static id="Static00" taborder="0" text="아이디" left="40" top="40" width="138" height="60" onclick="Static00_onclick" background="red" border="1px solid" borderRadius="8px" textAlign="center" font="24px/normal &quot;Gulim&quot;" color="#fff" verticalAlign="middle"/>
        <Static id="Static00_00" taborder="1" text="비밀번호" left="40" top="120" width="138" height="60" onclick="Static00_onclick" background="red" border="1px solid" borderRadius="8px" textAlign="center" font="24px/normal &quot;Gulim&quot;" color="#fff"/>
        <Edit id="ed_id" taborder="2" left="190" top="52" width="254" height="36" onchanged="Edit00_onchanged"/>
        <Edit id="ed_pw" taborder="3" left="190" top="134" width="254" height="36"/>
        <Button id="Button00" taborder="4" text="로그인" left="480" top="84" width="145" height="50" borderRadius="12px" onclick="Button00_onclick" font="bold 24px/normal &quot;Gulim&quot;" color="red"/>
      </Layout>
    </Layouts>
    <Script type="xscript5.1"><![CDATA[
this.Form_Main_onload = function(obj:nexacro.Form,e:nexacro.LoadEventInfo)
{
	trace(">>>");
};

this.Button00_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{	
	var userId = this.ds_user.getColumn(0, "user_id");
	var userPw = this.ds_user.getColumn(0, "user_pw");
	
	
	if(userId == null || userId =='undefined' || userId == ''){
		this.alert("아이디 입력");
		return;
	}
	
	if(userPw == null || userPw =='undefined' || userPw == ''){
		this.alert("비밀번호 입력");
		return;
	}
	
	//return;
	
	var strSvcID = "selectUser";		//트랜잭션 아이디
	var strURL = "svc::selectUser.do";	//url controller에서 받을 주소
	var strDatasets = "ds_user=ds_user";
	var strOutDatasets = "ds_login=ds_login";
	var strArg = "";					//변수선언
	var callBack = "fn_callBack";
	var inAsync = true;					//동기 비동기 그런거
	
	this.transaction(strSvcID,strURL,strDatasets,strOutDatasets,strArg,callBack,inAsync);
	
	
};


this.fn_callBack = function(id, errCode, errMsg){
	
	if(id === "selectUser"){
	
		var glbAd = nexacro.getApplication();
	
		if(errCode < 0){
			this.alert("로그인 중 오류 발생 : " + errMsg);
			return;
		}
		
		var userId = this.ds_login.getColumn(0, "USER_ID");
		var userName = this.ds_login.getColumn(0, "NAME");
		
		if(userName != null && userName != ''){
			this.alert("로그인 성공!");
			//0번째 행의 "user_id"컬럼에 3번째 매개변수를 저장하겠따.
			glbAd.gds_userInfo.setColumn(0, "user_id", userId);
			
			this.ds_login.clear();
			
			this.getOwnerFrame().set_formurl("board::Form_Board.xfdl");
			
		} else {
			this.alert("아이디 또는 비밀번호가 올바르지 않습니다.");
			
			this.ds_login.clear();
		}
	}
	
};


]]></Script>
    <Objects>
      <Dataset id="ds_user">
        <ColumnInfo>
          <Column id="user_id" type="STRING" size="256"/>
          <Column id="user_pw" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_login">
        <ColumnInfo>
          <Column id="USER_ID" type="STRING" size="256"/>
          <Column id="PASS" type="STRING" size="256"/>
          <Column id="SALT" type="STRING" size="256"/>
          <Column id="NAME" type="STRING" size="256"/>
          <Column id="MAIL" type="STRING" size="256"/>
          <Column id="ADDRESS" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item0" compid="ed_id" propid="value" datasetid="ds_user" columnid="user_id"/>
      <BindItem id="item1" compid="ed_pw" propid="value" datasetid="ds_user" columnid="user_pw"/>
    </Bind>
  </Form>
</FDL>
